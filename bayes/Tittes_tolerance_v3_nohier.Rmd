---
title: "tolerance curves"
author: "Silas Tittes"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  pdf_document:
    fig_caption: yes
---

## Data prep
```{r}
source("bayes/tolerance_functions.R")
emery <- load_emery()
```


## The model
```{r}
dataList <- list(N = nrow(emery), 
		 x = emery$treat, 
		 y = emery$Inflor_biomass,
		 numSpp = length(unique(emery$sppint)),
		 sppint = emery$sppint
		)
```


Gamma scaled version -- best
```{r}
watch <- c("a", "b", "c","d", "e", "e1", "mu",
           "nu", "beta_0", "beta_1", "var_c", "mean_c")
stan.fit <- stan(file = "bayes/tolerance_zig_v3_nohier.stan",
                     data = dataList,
                 iter = 5000, chains = 4,
                 pars = watch,
                sample_file = "bayes/tolerance_zig_v3_nohier.samples",
                diagnostic_file = "bayes/tolerance_zig_v3_nohier.diag"
)
```


Normal model version -- meh
```{r, eval=FALSE}
#watch <- c("a", "b", "c","d", "e", "e1")
#stan.fit <- stan(file = "tolerance_zig_vNormal_nohier.stan",
#                     data = dataList,
#                 iter = 5000, chains = 4,
#                 pars = watch,
#                sample_file = "tolerance_zig_vNormal_nohier.samples",
#                diagnostic_file = "tolerance_zig_vNormal_nohier.diag"
#)
```
